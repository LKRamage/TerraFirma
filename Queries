--Queries 1 to 5 should be able to be produced.
--Query_1
DROP VIEW Query_1;
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100
CREATE VIEW QUERY_1 AS
SELECT act.Serial_Nbr, ad.AD_Type, ad.AD_Description, ad.Capacity, ad.AC_Range, ad.Capacity - 150 AS Cap_Overage
FROM Aircraft_Data ad, Aircraft_Type act
WHERE act.AD_Type = ad.AD_Type
AND ad.Capacity > 150
ORDER BY act.Serial_Nbr;
TTITLE 'Query 1'
BREAK ON act.Serial_Nbr;
COLUMN Serial_Nbr FORMAT A11;
COLUMN AD_Type FORMAT A11;
SELECT * FROM Query_1;
--Query_2
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100
CREATE VIEW QUERY_2 AS
SELECT
sf.Flight_Nbr,
sf.Serial_Nbr,
sf.Flight_Date,
act.AD_Type
FROM
Sched_Flight sf
JOIN Aircraft_Type act ON act.Serial_Nbr = sf.Serial_Nbr
WHERE Flight_Date = '12-JUL-22' AND
(Flight_Nbr = 181 
OR Flight_Nbr = 285
OR Flight_Nbr = 887
OR Flight_Nbr = 950)
ORDER BY Flight_Nbr, Serial_Nbr;
SELECT * FROM Query_2;
--Query_4
DROP VIEW Query_4;
TTITLE OFF
CREATE VIEW Query_4 AS
SELECT DISTINCT sf.Flight_date, act.Serial_Nbr, ad.AD_Type, ad.AD_Description, ad.Capacity, ad.AC_Range
FROM Sched_Flight sf CROSS JOIN Aircraft_Type act
JOIN Aircraft_Data ad ON (ad.AD_Type = act.AD_Type)
MINUS
SELECT Flight_Date, Serial_Nbr, AD_Type, AD_Description, Capacity, AC_Range
FROM Sched_Flight JOIN Aircraft_Type USING(Serial_Nbr)
JOIN Aircraft_Data USING(AD_Type)
ORDER BY Flight_Date;
TTITLE 'Query 4'
SELECT * FROM QUERY_4;
--Query_5
DROP VIEW Query_5;
CREATE VIEW Query_5 AS
SELECT DISTINCT
v.Flight_Nbr, v.Flight_Date, v.Cust_Nbr, v.Aprt_Code,
v.City_Name, v.Dep_Time, v.Dep_Aprt_Code, fd.Arr_Aprt_Code, sf.Arr_Time
FROM View_2 v
JOIN Flight_Data fd ON fd.Flight_Nbr = v.Flight_Nbr
JOIN Sched_Flight sf ON sf.Flight_Nbr = v.Flight_Nbr
ORDER BY Cust_Nbr, Aprt_Code, Dep_Time;
SELECT * FROM Query_5;