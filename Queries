--Queries 1 to 5 should be able to be produced.
--Query_1
DROP VIEW Query_1;
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100
CREATE VIEW QUERY_1 AS
SELECT act.Serial_Nbr, ad.AD_Type, ad.AD_Description, ad.Capacity, ad.AC_Range, ad.Capacity - 150 AS Cap_Overage
FROM Aircraft_Data ad, Aircraft_Type act
WHERE act.AD_Type = ad.AD_Type
AND ad.Capacity > 150
ORDER BY act.Serial_Nbr;
TTITLE 'Query 1'
BREAK ON act.Serial_Nbr;
COLUMN Serial_Nbr FORMAT A11;
COLUMN AD_Type FORMAT A11;
SELECT * FROM Query_1;
--Query_4
DROP VIEW Query_Four_July12;
DROP VIEW Query_Four_July13;
DROP VIEW Query_Four_July14;
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100
CREATE VIEW Query_Four_July12 AS
SELECT sf.Flight_Date, act.AD_Type, ad.AD_description, ad.Capacity, ad.AC_range, act.Serial_Nbr
FROM Aircraft_Type act
JOIN Aircraft_Data ad ON act.AD_Type = ad.AD_Type
JOIN Sched_Flight sf ON  sf.Serial_Nbr = act.Serial_Nbr
JOIN Flight_Data fd ON fd.Flight_Nbr = sf.Flight_Nbr
WHERE sf.Flight_Date NOT LIKE '07-12-2000%'
ORDER BY sf.Flight_Date;
BREAK ON act.Serial_Nbr;
CREATE VIEW Query_Four_July13 AS
SELECT sf.Flight_Date, act.AD_Type, ad.AD_description,
ad.Capacity, ad.AC_range, act.Serial_Nbr
FROM Aircraft_Type act
JOIN Aircraft_Data ad ON act.AD_Type = ad.AD_Type
JOIN Sched_Flight sf ON  SF.Serial_Nbr = ACT.Serial_Nbr
JOIN Flight_Data fd ON fd.Flight_Nbr = sf.Flight_Nbr
WHERE sf.Flight_Date NOT LIKE '07-13-2000%'
ORDER BY sf.Flight_Date;
BREAK ON act.Serial_Nbr;
CREATE VIEW Query_Four_July14 AS
SELECT sf.Flight_Date, act.AD_Type, ad.AD_description,
ad.Capacity, ad.AC_range, act.Serial_Nbr
FROM Aircraft_Type act
JOIN Aircraft_Data ad ON act.AD_Type = ad.AD_Type
JOIN Sched_Flight sf ON  sf.Serial_NBR = act.Serial_Nbr
JOIN Flight_Data fd ON fd.Flight_NBR = sf.Flight_Nbr
WHERE sf.Flight_Date NOT LIKE '07-14-2000%'
ORDER BY sf.Flight_Date;
BREAK ON act.Serial_Nbr;
Join Query_Four_July12 
SELECT * FROM Query_Four_July12;
SELECT * FROM Query_Four_July13;
SELECT * FROM Query_Four_July14;
--Query_5
DROP VIEW Query_5;
CREATE VIEW Query_5 AS
SELECT DISTINCT
v.Flight_Nbr, v.Flight_Date, v.Cust_Nbr, v.Aprt_Code,
v.City_Name, v.Dep_Time, v.Dep_Aprt_Code, fd.Arr_Aprt_Code, sf.Arr_Time
FROM View_2 v
JOIN Flight_Data fd ON fd.Flight_Nbr = v.Flight_Nbr
JOIN Sched_Flight sf ON sf.Flight_Nbr = v.Flight_Nbr
ORDER BY Cust_Nbr, Aprt_Code, Dep_Time;
SELECT * FROM Query_5;


--Diff q4, 
DROP VIEW Query_4;
TTITLE OFF
CREATE VIEW Query_4 AS
SELECT DISTINCT sf.Flight_date, act.Serial_Nbr, ad.AD_Type, ad.AD_Description, ad.Capacity, ad.AC_Range
FROM Sched_Flight sf CROSS JOIN Aircraft_Type act
JOIN Aircraft_Data ad ON (ad.AD_Type = act.AD_Type)
MINUS
SELECT Flight_Date, Serial_Nbr, AD_Type, AD_Description, Capacity, AC_Range
FROM Sched_Flight JOIN Aircraft_Type USING(Serial_Nbr)
JOIN Aircraft_Data USING(AD_Type)
ORDER BY Flight_Date;
TTITLE 'Query 4'
SELECT * FROM QUERY_4;