--Views 1 and 2 should be able to be created.
--View_1
DROP VIEW View_1;
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100
Column Flight_Date FORMAT A11
CREATE VIEW View_1 AS
SELECT Flight_Nbr, Flight_Date, Capacity - COUNT(Cust_Nbr) AS Seats_Available
FROM Reservation
JOIN Sched_Flight USING (Flight_Nbr, Flight_Date)
JOIN Aircraft_Type USING (Serial_Nbr)
JOIN Aircraft_Data USING (AD_Type)
GROUP BY Flight_Nbr, Flight_Date, Capacity;
TTITLE 'View 1'
BREAK ON r.Flight_Nbr;
SELECT * FROM View_1;
--View_2
DROP VIEW View_2;
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 80
SET Linesize 100
CREATE VIEW View_2 AS
SELECT DISTINCT fd.Dep_Aprt_Code, res.Flight_Nbr,
res.Flight_Date, res.Cust_Nbr, aprt.Aprt_code, c.City_Name, sf.Dep_Time
FROM Sched_Flight sf
JOIN Reservation res ON res.Flight_Nbr = sf.Flight_Nbr AND res.Flight_Date = sf.Flight_Date
JOIN Flight_Data fd ON res.Flight_Nbr = fd.Flight_Nbr
JOIN Airport aprt ON fd.Dep_Aprt_Code = aprt.Aprt_Code
JOIN City c ON c.City_Code = aprt.City_Code
ORDER BY Dep_Aprt_Code, Flight_Nbr, Flight_Date, Cust_Nbr;
SELECT * FROM View_2;
commit;